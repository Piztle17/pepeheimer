(function(o,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(o=typeof globalThis<"u"?globalThis:o||self,s(o.spacepad={}))})(this,function(o){"use strict";const s="spacepad_project_id",u="spacepad_clk_id",p="clkId",r="adsClkId";function a(t){return`spacepad_${t}`}function d(t,n){return typeof n=="object"&&(n=JSON.stringify(n)),localStorage.setItem(a(t),n)}function l(t,n=!1){let i=localStorage.getItem(a(t));return i&&I(i)&&(i=JSON.parse(i)),n&&i&&i.timeout&&new Date(i.timeout).getTime()<new Date().getTime()?(localStorage.removeItem(a(t)),null):i}function I(t){try{return Object.keys(JSON.parse(t)).length>0}catch{return!1}}const k=(t,n,i)=>{const e=new Date;e.setTime(e.getTime()+i*24*60*60*1e3);const c="expires="+e.toUTCString();document.cookie=t+"="+n+";"+c+";path=/"},h=t=>{let n=t+"=",i=document.cookie.split(";");for(let e=0;e<i.length;e++){let c=i[e];for(;c.charAt(0)==" ";)c=c.substring(1);if(c.indexOf(n)==0)return c.substring(n.length,c.length)}return""},m=t=>{const n=new URLSearchParams(window.location.search);return Object.fromEntries(n.entries())[t]||""};async function f(t,n={}){let i=await l(s);if(!i)return;let e="https://kolab.network/";window.location.hostname=="localhost"&&(e="http://localhost:3002/"),fetch(`${e}api/v1/track/web/event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:t,properties:n,timestamp:new Date,url:window.location.href,project_id:i,clkId:l(u)||h(a("clkId"))||m("clkId"),adsClkId:l(r)||h(a("adsClkId"))||m("adsClkId")})})}async function g(t){let n=l(s);console.log("storedId -> ",n),(!n||n!=t)&&(d(s,t),f("init",{projectId:t}));const i=new URLSearchParams(window.location.search),e=Object.fromEntries(i.entries());e&&(e[p]&&d(u,e[p]),e[r]&&d(r,e[r]),e!=null&&e.clkId&&k(a("clkId"),e.clkId,365),e!=null&&e.adsClkId&&k(a("adsClkId"),e.adsClkId,365))}function w(t,n){switch(t){case"init":g(n);break;default:f(t,n);break}}o.spacepad_init=g,o.spacepad_track=f,o.track=w,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
